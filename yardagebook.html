<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>ForeThought — Yardage Book Utility</title>
<meta name="description" content="Yardage Book utility for ForeThought and Lesson Logger Companion." />

<link rel="stylesheet" href="style.css"/>

<style>
.card{border:1px solid var(--line);border-radius:14px;padding:18px;margin-bottom:28px}
label{display:block;font-weight:500;margin-bottom:6px}
table{width:100%;border-collapse:collapse;margin-bottom:10px}
th,td{padding:8px;border-bottom:1px solid var(--line);font-size:14px}
th{text-align:left;color:var(--muted);font-size:12px}
input{width:100%;padding:6px 8px;border-radius:8px;border:1px solid var(--line);font-family:inherit}
button{padding:8px 12px;border-radius:10px;border:1px solid var(--line);background:#fff;cursor:pointer}
button.primary{background:#111;color:#fff;border-color:#111}
.btnRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
.drop{border:1px dashed var(--line);border-radius:14px;padding:14px;text-align:center;margin-bottom:14px}
textarea{width:100%;border-radius:10px;padding:10px;border:1px solid var(--line);font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:12px}
.hint{font-size:13px;color:var(--muted)}
.compat{font-size:13px;color:var(--muted);margin-top:6px}
</style>
</head>

<body>

<nav class="topnav">
  <div class="nav-inner">
    <div class="nav-left">
      <a href="index.html" class="brand">ForeThought</a>
    </div>
    <div class="nav-right">
      <a href="features.html">Features</a>
      <a href="how-it-works.html">How it works</a>
      <a href="lesson-logger.html">Lesson Logger</a>
      <a href="yardage-book.html" class="active">Yardage Book</a>
      <a href="availability.html">Availability</a>
    </div>
  </div>
</nav>

<main class="container">

<h1>Yardage Book</h1>
<div class="compat">ForeThought export / import compatible</div>

<p class="lede">
Create and maintain yardage data used by ForeThought and Lesson Logger Companion.
</p>

<p class="hint">
Yardage data is captured and refined outside of live play to keep the process deliberate,
editable, and under your control.
</p>

<hr/>

<div class="card">

<label>Club yardages</label>

<table>
<thead>
<tr><th>Club</th><th>Carry</th><th>Total</th><th></th></tr>
</thead>
<tbody id="clubBody"></tbody>
</table>

<button type="button" id="addClub" class="primary">+ Add club</button>

<hr/>

<label>Wedge matrix (partial swings)</label>

<table>
<thead>
<tr><th>Wedge</th><th>¼</th><th>½</th><th>¾</th><th>Full</th><th></th></tr>
</thead>
<tbody id="wedgeBody"></tbody>
</table>

<button type="button" id="addWedge">+ Add wedge</button>

<div class="btnRow">
  <button type="button" class="primary" id="download">Download YardageBook.json</button>
  <button type="button" onclick="printYardages()">Save yardages as PDF</button>
  <button type="button" onclick="printWedges()">Save wedge matrix as PDF</button>
</div>
<p><section>
    <div class="hint">
        The file you download can be stored in <b>Files</b> (“On My iPhone/iPad” or iCloud Drive).
        In Lesson Logger, use <b>Yardages → Link YardageBook.json</b> to select it once.
      </div>
    </section></p>
  
<hr/>

<label>Import existing yardage data</label>

<div class="drop">
  Drag & drop a YardageBook.json file here, or
  <button type="button" onclick="importFile.click()">Choose file</button>
  <input id="importFile" type="file" accept="application/json" hidden>
</div>

<label>Generated data (read-only)</label>
<textarea id="preview" rows="16" readonly></textarea>

<p class="hint" style="margin-top:12px">
This utility is part of the ForeThought workflow and is not intended as a standalone product.
</p>

<img src="img/data-flow.png" alt="ForeThought data flow diagram" class="screenshot"> 
<section>
  <h2>Why JSON?</h2>

  <p>
    ForeThought uses simple <code>.json</code> files to move data between tools
    because they are lightweight, transparent, and easy to control.
  </p>

  <p>
    A JSON file is plain text. It can be stored anywhere, copied freely,
    backed up easily, and inspected if needed — without requiring a cloud
    account, login, or background service.
  </p>

  <p>
    This approach keeps your data portable and future-proof.
    Yardage data created here can be reused across ForeThought and
    Lesson Logger Companion without locking it into a single device
    or platform.
  </p>

  <p class="hint">
    Using JSON also allows ForeThought to remain a local-first application,
    where you decide how and where your data is stored.
  </p>
</section>
</div>

</main>

<script>
/* -------- DOM -------- */
const clubBody   = document.getElementById("clubBody");
const wedgeBody  = document.getElementById("wedgeBody");
const preview    = document.getElementById("preview");
const importFile = document.getElementById("importFile");

/* -------- STATE -------- */
let state = { clubs: [], wedgeMatrix: [] };

/* -------- RENDER -------- */
function render(){
  clubBody.innerHTML = "";
  state.clubs.forEach((c,i)=>{
    clubBody.insertAdjacentHTML("beforeend", `
      <tr>
        <td><input value="${c.name||""}" oninput="state.clubs[${i}].name=this.value;sync()"></td>
        <td><input value="${c.carry||""}" oninput="state.clubs[${i}].carry=+this.value;sync()"></td>
        <td><input value="${c.total||""}" oninput="state.clubs[${i}].total=+this.value;sync()"></td>
        <td><button type="button" onclick="state.clubs.splice(${i},1);render()">✕</button></td>
      </tr>
    `);
  });

  wedgeBody.innerHTML = "";
  state.wedgeMatrix.forEach((w,i)=>{
    wedgeBody.insertAdjacentHTML("beforeend", `
      <tr>
        <td><input value="${w.name||""}" oninput="state.wedgeMatrix[${i}].name=this.value;sync()"></td>
        <td><input value="${w.q||""}" oninput="state.wedgeMatrix[${i}].q=+this.value;sync()"></td>
        <td><input value="${w.h||""}" oninput="state.wedgeMatrix[${i}].h=+this.value;sync()"></td>
        <td><input value="${w.tq||""}" oninput="state.wedgeMatrix[${i}].tq=+this.value;sync()"></td>
        <td><input value="${w.f||""}" oninput="state.wedgeMatrix[${i}].f=+this.value;sync()"></td>
        <td><button type="button" onclick="state.wedgeMatrix.splice(${i},1);render()">✕</button></td>
      </tr>
    `);
  });

  sync();
}

/* -------- JSON -------- */
function buildJSON(){
  return {
    type:"yardageBook",
    generatedAt:new Date().toISOString(),
    units:"yd",
    clubs: state.clubs.filter(c=>c.name),
    wedgeMatrix: state.wedgeMatrix.length
      ? state.wedgeMatrix.map(w=>({
          name:w.name,
          swings:{quarter:w.q,half:w.h,threeQuarter:w.tq,full:w.f}
        }))
      : undefined
  };
}

function sync(){
  preview.value = JSON.stringify(buildJSON(), null, 2);
}

/* -------- ACTIONS -------- */
addClub.onclick  = ()=>{ state.clubs.push({}); render(); };
addWedge.onclick = ()=>{ state.wedgeMatrix.push({}); render(); };

download.onclick = ()=>{
  const blob = new Blob([JSON.stringify(buildJSON(),null,2)],{type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "YardageBook.json";
  a.click();
};

/* -------- PDF -------- */
function openPrint(title, table){
  const w = window.open("");
  w.document.write(`
    <style>
      @page{size:A6;margin:8mm}
      body{font-family:-apple-system,system-ui;margin:0}
      h1{text-align:center;font-size:14px;margin-bottom:8px}
      table{width:100%;border-collapse:collapse}
      th,td{font-size:12px;padding:6px;border-bottom:1px solid #ccc}
    </style>
    <h1>${title}</h1>${table}
    <script>window.onload=()=>window.print();<\/script>
  `);
  w.document.close();
}

function printYardages(){
  openPrint("Yardages",
    `<table><tr><th>Club</th><th>Carry</th><th>Total</th></tr>
    ${state.clubs.map(c=>`<tr><td>${c.name}</td><td>${c.carry}</td><td>${c.total}</td></tr>`).join("")}
    </table>`);
}

function printWedges(){
  openPrint("Wedge Matrix",
    `<table><tr><th>Wedge</th><th>¼</th><th>½</th><th>¾</th><th>Full</th></tr>
    ${state.wedgeMatrix.map(w=>`<tr><td>${w.name}</td><td>${w.q}</td><td>${w.h}</td><td>${w.tq}</td><td>${w.f}</td></tr>`).join("")}
    </table>`);
}

/* -------- IMPORT -------- */
importFile.onchange = async e=>{
  const o = JSON.parse(await e.target.files[0].text());
  state.clubs = o.clubs || [];
  state.wedgeMatrix = (o.wedgeMatrix||[]).map(w=>({
    name:w.name,
    q:w.swings.quarter,
    h:w.swings.half,
    tq:w.swings.threeQuarter,
    f:w.swings.full
  }));
  render();
};

render();
</script>

</body>
</html>
